<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
{% assign page_description = page.description | default: site.description %}
{% assign og_image = page.og_image | default: "/assets/images/og-default.svg" %}
{% assign og_image_url = og_image | relative_url | absolute_url %}
{% assign is_article = page.layout == "article" %}
{% assign published_time = page.date %}
{% assign modified_time = page.last_modified_at | default: page.updated %}
<title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
<meta name="description" content="{{ page_description }}">
<link rel="canonical" href="{{ page.url | absolute_url }}">
<link rel="icon" type="image/svg+xml" href="{{ "/assets/images/favicon.svg" | relative_url }}">
<meta name="theme-color" content="#050816">
<script>
  (function () {
    var stored = localStorage.getItem('theme') || 'system';
    var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    var resolved = stored === 'dark' || (stored === 'system' && prefersDark) ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', resolved);
    document.documentElement.setAttribute('data-theme-preference', stored);
  })();
</script>
<link rel="stylesheet" href="{{ "/assets/css/main.css" | relative_url }}">

<meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}">
<meta property="og:description" content="{{ page_description }}">
<meta property="og:type" content="{% if is_article %}article{% else %}website{% endif %}">
<meta property="og:url" content="{{ page.url | absolute_url }}">
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:image" content="{{ og_image_url }}">
{% if is_article and published_time %}
<meta property="article:published_time" content="{{ published_time | date_to_xmlschema }}">
{% endif %}
{% if is_article and modified_time %}
<meta property="article:modified_time" content="{{ modified_time | date_to_xmlschema }}">
{% endif %}
<meta name="twitter:card" content="summary_large_image">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{% if is_article %}Article{% else %}WebSite{% endif %}",
  "name": {{ site.title | jsonify }},
  {% if is_article and page.title %}
  "headline": {{ page.title | jsonify }},
  {% endif %}
  "url": {{ page.url | absolute_url | jsonify }}{% if is_article and published_time %},
  "datePublished": {{ published_time | date_to_xmlschema | jsonify }}{% endif %}{% if is_article and modified_time %},
  "dateModified": {{ modified_time | date_to_xmlschema | jsonify }}{% endif %}{% if og_image_url %},
  "image": {{ og_image_url | jsonify }}{% endif %}
}
</script>

{% if site.analytics.ga4_measurement_id and site.analytics.ga4_measurement_id != "" %}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.analytics.ga4_measurement_id }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '{{ site.analytics.ga4_measurement_id }}');
</script>
{% endif %}

{% if site.analytics.matomo_url and site.analytics.matomo_site_id and site.analytics.matomo_url != "" and site.analytics.matomo_site_id != "" %}
<script>
  var _paq = window._paq = window._paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="{{ site.analytics.matomo_url }}";
    _paq.push(['setTrackerUrl', u + 'matomo.php']);
    _paq.push(['setSiteId', '{{ site.analytics.matomo_site_id }}']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u + 'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
{% endif %}
